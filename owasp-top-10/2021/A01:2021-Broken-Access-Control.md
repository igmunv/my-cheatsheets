# A01: Broken Access Control
или **Нарушенный контроль доступа**

## Описание
Система контроля доступа обеспечивает соблюдение того, чтобы пользователи могли действовать в рамках только своих полномочий, т.е обеспечивает разграничение прав и механизм проверки. Например, только пользователю Бухгалтер доступны исключительно финансовые документы, а другим пользователям доступ к ним запрещён.

Broken Access Control - это ситуация когда система неправильно реализует механизм проверки.

Существует несколько типов контроля доступа, также как и уязвимостей, связанных с их нарушением:
1. Вертикальный контроль доступа

   Используется для ограничения доступа к **разным функция** приложения в зависимости от **типа пользователя**.

   `Администратор может удалять аккаунты пользователй, в то время как обычные пользователи не имею доступа к данной функции`
    
2. Горизонтальный контроль доступа

   Используется для ограничения доступа к **данным и правам** пользователя от **других таких же пользователей**.

   `Пользователь получает данные только своего аккаунта в приложении, в то время как другие пользователи не могут получить его данные, только свои`
   
3. Контекстно-зависимый контроль доступа

   Используется для ограничение доступа к **функциям и ресурсам** в зависимости от **состояния приложения и взаимодействия пользователя с ним**, основываясь на определенных контекстуальных параметрах, таких как местоположение, время и последовательность ответов.

   `Не позволит пользователю выполнить действия в неправильном порядке`

   `Пользователь совершает покупку в интернет магазине, после оплаты он не сможет поменять содержимое корзины (купленных предметов)`
   



## Пример

Вертикальный: скрытие URL админ панели /admin на менее предсказуемый, к примеру: /adm-123-qwe. В результате обычный пользователь имеет доступ к правам администратора.

Горизонтальный: получение данных в зависимости от передаваемого идентификатора или значения, к примеру в GET запросе передается идентификатор текущего пользователя `?id=123`. Если его изменить, то можно получить данные другого пользователя `?id=456`.

Контекстно-зависимый: Пользователь совершает покупку в интернет магазине, после оплаты он может изменить содержимое корзины (купленных предметов).

Как может проявляться нарушение контроля доступа (ПРИМЕРЫ):
1. Неполная или отсутствующая аунтефикация. Позволяет неавторизованный доступ. Даёт возможность получение доступа к ограниченным ресурсам.

2. Отсутствие надлежащих проверок авторизации. Недосточная проверка может привести к неавторизованным действиям (удаление конфиденциальных данных).

3. Прямые ссылки на объекты. Прямое обращение к объектам (файлы или БД) без надлежащих проверок может привести к неавторизованному доступу. Можно изменить URL и получить доступ к неавторизованным ресурсам.

4. Слишком широкие права доступа. Может происходить в случаях, когда администраторы предоставляют разрешения основываясь на удобстве, а не на принципе наименьших привилегий. 


## Уязвимости


## Последствия


## Методы обнаружения


## Рекомендации по исправлению
1. Регулярная проверка и обновление списка контроля доступа
   
   `убедитесь, что доступ имеют только авторизованные пользователи и что их разрешения соответствуют их ролям и обязанностям`

2. Соблюдение принципа наименьших привилегий

   `предоставляйте пользователям только те права, которые необходимы для выполнения их ролей`

3. Внедрение корректного управления сессиями

   `убедитесь что пользователи проходят повторную аунтефикацию, когда это необходимо, и что сессии завершаются своевременно`
  
4. Использование надежных методов аунтефикации

   `внедряйте сильные методы аунтефикации, такие как двухфакторная аунтефикация`

5. Проведение регулярных проверок безопасности и тестов на проникновение

6. Наблюдение и применение последних стандартов безопасности и лучших практик
